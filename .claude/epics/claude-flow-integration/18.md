---
name: Per-Issue Workflow Template & Claude Flow Integration
status: closed
created: 2025-08-29T22:51:03Z
updated: 2025-08-30T19:11:12Z
github: https://github.com/microservice-tech/ccpm/issues/18
depends_on: []
parallel: false
conflicts_with: []
completion: 100
---

# Task: Per-Issue Workflow Template & Claude Flow Integration

## Description
Create a workflow template that the background service will execute for each GitHub issue. This template includes creating an isolated workspace, cloning the repository, creating a feature branch, installing Claude Flow locally within that workspace, executing the hive-mind implementation, handling feedback, creating the PR, and cleaning up. This approach ensures complete isolation between issues and prevents state contamination.

## Acceptance Criteria
- [ ] Workflow template script created for per-issue execution
- [ ] Isolated workspace creation logic implemented
- [ ] Repository cloning and branch creation automated
- [ ] Local Claude Flow installation within workspace working
- [ ] Hive-mind spawn command with issue context integration
- [ ] PR creation workflow after implementation complete
- [ ] Workspace cleanup after PR creation
- [ ] Complete isolation verified between concurrent issues

## Technical Details
### Per-Issue Workflow Template
```bash
#!/bin/bash
# workflow-template.sh - Executed by service for each issue

ISSUE_ID=$1
ISSUE_TITLE=$2
REPO_URL=$3

# 1. Create isolated workspace
WORKSPACE="/tmp/claude-flow-issues/issue-${ISSUE_ID}"
mkdir -p "$WORKSPACE"
cd "$WORKSPACE"

# 2. Clone repository and create branch
git clone "$REPO_URL" .
git checkout -b "feature/issue-${ISSUE_ID}"

# 3. Install Claude Flow locally
npm init -y
npm install claude-flow@alpha
npx claude-flow init --force

# 4. Execute hive-mind implementation
npx claude-flow@alpha hive-mind spawn \
  "Implement GitHub issue #${ISSUE_ID}: ${ISSUE_TITLE}. \
  Read the issue, implement the solution, write tests, \
  and prepare for PR creation." --claude

# 5. Monitor and handle feedback
# (Loop for status checks and iterations)

# 6. Create PR
git add -A
git commit -m "feat: implement issue #${ISSUE_ID}"
git push origin "feature/issue-${ISSUE_ID}"
gh pr create --title "Fix #${ISSUE_ID}: ${ISSUE_TITLE}" \
  --body "Automated implementation by Claude Flow hive-mind"

# 7. Cleanup workspace
cd /
rm -rf "$WORKSPACE"
```

### Isolation Strategy
- Each issue runs in `/tmp/claude-flow-issues/issue-{id}/`
- Complete workspace deletion after PR creation
- No global Claude Flow installation needed
- .swarm directories contained within workspace
- Natural isolation prevents state leakage between issues

## Dependencies
- [ ] Node.js 18+ runtime environment
- [ ] npm package manager
- [ ] Internet connection for package downloads
- [ ] Anthropic API key configured

## Effort Estimate
- Size: M
- Hours: 12
- Parallel: false (must complete before other tasks)

## Definition of Done
- [ ] Workflow template script created and tested
- [ ] Isolated workspace creation verified
- [ ] Local Claude Flow installation successful
- [ ] Hive-mind execution with issue context working
- [ ] PR creation automated after implementation
- [ ] Workspace cleanup removes all artifacts
- [ ] Concurrent issue isolation verified
- [ ] No global dependencies required
